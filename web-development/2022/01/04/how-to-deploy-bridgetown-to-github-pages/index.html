<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<title>How to deploy Bridgetown to Github Pages | Your awesome title</title>

<meta name="description" content="Write an awesome description for your new site here. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />

<link rel="stylesheet" href="/bridgetown-gh-pages/_bridgetown/static/css/main.a82a669ccd5b09f8ef04.css" />
<script src="/bridgetown-gh-pages/_bridgetown/static/js/main.0811b103c2b1181ddec3.js" defer></script>

  </head>
  <body class="post ">
    <nav>
  <a href=/bridgetown-gh-pages/>Home</a>
  <a href=/bridgetown-gh-pages/about>About</a>
  <a href=/bridgetown-gh-pages/posts>Posts</a>

</nav>


    <main>
      <h1>How to deploy Bridgetown to Github Pages</h1>

<p>Github is a great place to host your static website. Unfortunately Bridgetown does not have good documentation for settting this up. The <code class="highlighter-rouge">https://github.com/andrewmcodes/bridgetown-gh-pages-action</code> has issues.</p>

<p>Configure Github Actions workflow by creating a file at <code class="highlighter-rouge">.github/workflows/deploy.yml</code> and populating it with this template:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">Build and Deploy</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">main</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy to GitHub Pages</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@master</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Setup Node</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/setup-node@v1</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">node-version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">16.x"</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Setup Ruby</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">ruby/setup-ruby@master</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">ruby-version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2.7.1"</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install Dependencies</span>
        <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">bundle config path vendor/bundle</span>
          <span class="s">bundle install</span>
          <span class="s">yarn install</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build site for deployment</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">yarn deploy --base_path="/&lt;project-name&gt;"</span> <span class="c1"># your repository name</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy to GitHub Pages</span>
        <span class="na">if</span><span class="pi">:</span> <span class="s">success()</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">crazy-max/ghaction-github-pages@v2</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">target_branch</span><span class="pi">:</span> <span class="s">gh-pages</span> <span class="c1"># target branch</span>
          <span class="na">build_dir</span><span class="pi">:</span> <span class="s">output</span>
        <span class="na">env</span><span class="pi">:</span>
          <span class="na">GITHUB_TOKEN</span><span class="pi">:</span> <span class="s">$</span>
</code></pre></div></div>

<p>This will install node and ruby, install dependencies, build the site, and push the compiled slug to the target branch <code class="highlighter-rouge">gh-pages</code>.</p>

<p>Notice the <code class="highlighter-rouge">base_path</code> option being passed to <code class="highlighter-rouge">yarn deploy</code>. This is neccessary because Github Pages serves your website on a path. Without this option the paths to dependencies will be wrong causing assets to 404.</p>

<p>Similarly, links will not have include the subpath. So you’ll want to create a plugin to apply to paths.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># /plugins/filters.rb</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="o">&lt;</span> <span class="no">SiteBuilder</span>
  <span class="k">def</span> <span class="nf">build</span>
    <span class="n">liquid_filter</span> <span class="s2">"link_path"</span> <span class="k">do</span> <span class="o">|</span><span class="n">url</span><span class="o">|</span>
      <span class="s2">"</span><span class="si">#{</span><span class="n">config</span><span class="p">.</span><span class="nf">base_path</span><span class="si">}#{</span><span class="n">url</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-liquid highlighter-rouge"><div class="highlight"><pre class="highlight"><code># /src/_components/navbar.liquid

&lt;nav&gt;
  &lt;a href=/bridgetown-gh-pages/&gt;Home&lt;/a&gt;
  &lt;a href=/bridgetown-gh-pages/about&gt;About&lt;/a&gt;
  &lt;a href=/bridgetown-gh-pages/posts&gt;Posts&lt;/a&gt;
&lt;/nav&gt;
</code></pre></div></div>

<p>Github will always attempt to build your project with Jekyll. In order to avoid this you’ll have to:</p>
<ul>
  <li>add <code class="highlighter-rouge">.nojekyll</code> file to the project root</li>
  <li>add <code class="highlighter-rouge">.nojekyll</code> file to the root of the <code class="highlighter-rouge">src</code> directory</li>
</ul>

<p>Now you will want to push these changes to <code class="highlighter-rouge">main</code> and then configure github settings pages to use <code class="highlighter-rouge">gh-pages</code> branch as source.</p>

<p>Github pages serves content on a subpath. This results in 404s for assets.</p>


    </main>

    <footer>
  Contact me at <a href="mailto:your-email@example.com">your-email@example.com</a>
</footer>

  </body>
</html>
